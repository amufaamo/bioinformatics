---
title: "STARのgenomeGenerate：RNA-seq解析を支えるゲノムの索引作り"
emoji: "🧬"
type: "tech"
topics: ["bioinformatics", "RNA-seq", "STAR", "genomics", "次世代シーケンサー"]
published: true
---

# はじめに

RNAシーケンス（RNA-seq）は、遺伝子の発現量を網羅的に解析するための強力な手法です。このRNA-seqデータ解析の初期段階で非常に重要な役割を果たすのが、リード（シーケンサーから出力される短い塩基配列）をゲノムやトランスクリプトームにマッピング（アライメント）する工程です。

数あるマッピングツールの中でも、`STAR (Spliced Transcripts Alignment to a Reference)` は、その高速性と精度から広く利用されています。この記事では、`STAR`を使用する上で最初に行う準備ステップである `genomeGenerate` について、生物学的な観点から、なぜこのステップが必要で、具体的に何を行っているのかを解説します。

# STARの`genomeGenerate`とは？

`STAR`の`genomeGenerate`ステップは、一言で言うと**「ゲノムの索引（インデックス）を作成する」**作業です。この索引があることで、後のマッピング処理を劇的に高速かつ正確に行うことが可能になります。

図書館で目的の本を探す場面を想像してみてください。

* **ゲノム配列 (FASTAファイル)**: 図書館の全蔵書に相当します。これは非常に巨大な遺伝情報のテキストデータです。
* **遺伝子アノテーション (GTF/GFFファイル)**: 蔵書目録や索引カードのようなもので、どの遺伝子がゲノムのどの位置にあり、どのような構造（エクソン、イントロンなど）をしているかの情報が記載されています。

`genomeGenerate`ステップでは、これらの情報を用いて、以下のような処理を行います。

### 1. 索引の作成

図書館の司書が、膨大な本の中から特定の本を素早く見つけ出せるように、詳細な索引簿を作成する作業をイメージしてください。`STAR`は、ゲノム配列と遺伝子アノテーション情報を読み込み、リードがゲノムのどの部分に由来するのかを高速に照合するための特殊なデータ構造（サフィックスアレイなどがベースになっています）を構築します。

### 2. スプライスジャンクションの考慮

真核生物の遺伝子は、タンパク質をコードする領域であるエクソンと、コードしない領域であるイントロンから構成されています。転写されたRNAは、スプライシングという過程を経てイントロンが除去され、エクソン同士が連結されて成熟mRNAとなります。

RNA-seqで得られるリードの中には、このエクソンとエクソンが繋がった境界部分（スプライスジャンクション）をまたいでいるものが多数存在します。`genomeGenerate`では、提供された遺伝子アノテーションファイル（GTF/GFF）に基づいて、既知のスプライスジャンクションの位置情報をあらかじめ索引に組み込みます。

これは、図書館の索引簿に「この章の次は、あの章に繋がっていますよ」という情報を事前に書き込んでおくようなものです。これにより、スプライスされたリードも正確にゲノム上の正しい位置（複数のエクソンにまたがる形で）にマッピングできるようになります。

# なぜ`genomeGenerate`が重要なのか？

この索引作成ステップは、RNA-seq解析の効率と精度に大きく貢献します。

* **高速化**: 事前に詳細な索引を作成しておくことで、何百万、何千万という膨大な数のリードを、ゲノム上の適切な位置に短時間でマッピングすることができます。もし索引がなければ、一つ一つのリードをゲノム配列全体に対して総当たりで照合する必要があり、現実的ではないほどの計算時間がかかってしまいます。
* **精度向上**: 特に、スプライスジャンクションの情報を索引に含めることで、スプライスされたリードのマッピング精度が大幅に向上します。これにより、同じ遺伝子から生み出される異なる種類のmRNA（スプライシングバリアントやアイソフォーム）の発現量の違いなどを、より正確に解析することが可能になります。

# 生物学者にとっての意義

`genomeGenerate`は、RNA-seqデータ解析における最初の、そして非常に重要な準備段階です。このステップを適切に行うことで、以下のような下流の解析がより信頼性の高いものになります。

* 遺伝子発現量の定量
* 発現変動遺伝子（DEG）の同定
* 新規転写産物の探索
* 選択的スプライシングパターンの解析

つまり、`genomeGenerate`は、実験で得られた貴重なRNA-seqデータから、意味のある生物学的な知見を引き出すための頑健な土台を築く作業と言えるでしょう。

**注意点**:
このゲノムインデックスは、使用するゲノム配列（リファレンスゲノムのバージョンなど）や遺伝子アノテーションファイルが変わらない限り、一度作成すれば繰り返し利用できます。しかし、ゲノムのアセンブリバージョンが更新されたり、より新しいアノテーション情報を使用したい場合は、その都度`genomeGenerate`を実行してインデックスを再構築する必要があります。

# まとめ

`STAR`の`genomeGenerate`ステップは、RNA-seqデータ解析におけるマッピング処理を高速かつ正確に行うために不可欠な「ゲノムの索引作成」プロセスです。スプライスジャンクションの情報も考慮することで、特に真核生物の複雑な転写産物を効率よく解析するための基盤を提供します。このステップを理解し適切に実行することが、質の高いRNA-seq解析結果を得るための第一歩となります。
